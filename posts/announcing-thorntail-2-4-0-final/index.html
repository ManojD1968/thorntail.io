<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="description" content="Thorntail Official Website"><link rel="icon" href="/favicon.ico"><link rel="alternate" type="application/rss+xml" title="RSS Feed for thorntail.io" href="/rss.xml"><title>Announcing Thorntail 2.4.0.Final | Thorntail</title><link rel="stylesheet" href="/assets/plugins/bootstrap/css/bootstrap.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="/assets/css/headers/header-default.css"><link rel="stylesheet" href="/assets/css/footers/footer-v1.css"><link rel="stylesheet" href="/assets/plugins/animate.css"><link rel="stylesheet" href="/assets/plugins/line-icons/line-icons.css"><link rel="stylesheet" href="/assets/plugins/parallax-slider/css/parallax-slider.css"><link rel="stylesheet" href="/assets/plugins/owl-carousel/owl-carousel/owl.carousel.css"><link rel="stylesheet" href="/assets/css/theme-colors/default.css" id="style_color"><link rel="stylesheet" href="/assets/css/theme-skins/dark.css"><link rel="stylesheet" href="/assets/css/custom.css"><link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,800"><link rel="stylesheet" media="screen" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="stylesheet" media="screen" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/default.min.css"><link rel="stylesheet" href="/css/site.css"></head><body><div class="header"><div class="container"><a href="/" class="logo"><img src="/images/thorntail_icon_rgb_64px.png" class="icon"><span style="font-size:20px;vertical-align:middle;color:#555;margin-left:10px">Thorntail</span></a><div class="topbar"><ul class="loginbar pull-right"><li class="hoverSelector"><a href="http://jboss.org">JBoss.org</a></li><li class="topbar-devider"></li><li class="hoverSelector"><a href="http://redhat.com">Red Hat</a></li><li class="hoverSelector"><img style="margin-left:10px" src="https://img.shields.io/maven-central/v/io.thorntail/bom.svg?maxAge=86400"></li></ul></div><button type="button" data-toggle="collapse" data-target="#navbar" aria-controls="navbar" aria-expanded="false" class="navbar-toggle"><span class="sr-only">Toggle Navigation</span><span class="fa fa-bars"></span></button></div><div id="navbar" aria-expanded="false" class="navbar-collapse mega-menu navbar-responsive-collapse collapse"><div class="container"><ul class="nav navbar-nav"><li><a href="/generator" class="dropdown-toggle">Generator</a></li><li><a href="/archive">Blog</a></li><li><a href="/documentation">Documentation</a></li><li><a href="/community">Community</a></li><li class="dropdown"><a href="#" data-toggle="dropdown" class="dropdown-toggle">Resources</a><ul class="dropdown-menu"><li><a href="/downloads">Downloads</a></li><li><a href="/resources">Presentations</a></li></ul></li></ul></div></div></div><div class="wrapper"><div class="breadcrumbs"><div class="container"><div class="pull-left"><h1>Blog</h1></div><div class="ul pull-right breadcrumb"><li class="active"><a href="/archive">Archive</a></li><li><span>Post</span></li></div></div></div><div class="container"><div class="row margin-top-20"><div class="col-md-10"><article id="article"><h1>Announcing Thorntail 2.4.0.Final</h1><div class="post-meta">By The Thorntail Team | Published Mar 18, 2019</div><div><div class="sect1">
<h2 id="_thorntail_2_4_0_final">Thorntail 2.4.0.Final</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Just in time for St. Patrick&#8217;s Day festivities, we bring you a new Thorntail release!</p>
</div>
<div class="sect2">
<h3 id="_what_s_new">What&#8217;s New?</h3>
<div class="ulist">
<ul>
<li>
<p>Java 11 support</p>
</li>
<li>
<p>MicroProfile 2.2 support</p>
</li>
<li>
<p>MicroProfile JWT improvements</p>
</li>
<li>
<p>Gradle improvements</p>
</li>
<li>
<p>Thorntail Runner improvements</p>
</li>
</ul>
</div>
<!-- more -->
</div>
</div>
</div>
<div class="sect1">
<h2 id="_java_11_support">Java 11 support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thorntail now works with Java 11, both for building an uberjar and running it.
Please note that <strong>modulepath is not supported</strong>; Thorntail only runs on classpath.</p>
</div>
<div class="sect2">
<h3 id="_known_issues">Known issues</h3>
<div class="paragraph">
<p>Migrating from Java 8 to 11 can be somewhat difficult, but fortunately, there&#8217;s many online resources to help you.
As one example, we can recommend <a href="https://blog.codefx.org/java/java-11-migration-guide/">All You Need To Know For Migrating To Java 11</a>.</p>
</div>
<div class="paragraph">
<p>You might specifically notice that some components that are brought in as transitive dependencies are still not fully ready for Java 11.
Often, there&#8217;s a newer version that works much better.
Here&#8217;s a few examples that you might notice:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://issues.jboss.org/browse/ISPN-9720">ISPN-9720</a>: <em>illegal reflective access operation</em> in Infinispan</p>
</li>
<li>
<p><a href="https://issues.jboss.org/browse/JBMAR-216">JBMAR-216</a>: wrong reflection usage in JBoss Marshalling</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These new versions will percolate to Thorntail over time, as we update to new WildFly releases.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_new_java_modules">Using new Java modules</h3>
<div class="paragraph">
<p>By now, you probably already know that Thorntail, being built on top of WildFly, has its own module system: JBoss Modules.
On Java 8, JBoss Modules imitate the Java module system, and on Java 9+, the two module systems are integrated.
In particular, this means that if you want to use some new feature from Java 11 that&#8217;s only available in an extra module, you also need to declare a module dependency.</p>
</div>
<div class="paragraph">
<p>A prime example is the new Java HTTP Client, which exists in the <code>java.net.http</code> module.
To be able to use it in a Thorntail application, it needs to express a dependency on this module.
However, Thorntail doesn&#8217;t support running on modulepath, so expressing a dependency does <em>not</em> mean adding <code>module-info.java</code>.
Instead, you use the same mechanism you&#8217;ve been using in WildFly and Thorntail all the time: <code>jboss-deployment-structure.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0"?&gt;
&lt;jboss-deployment-structure&gt;
    &lt;deployment&gt;
        &lt;dependencies&gt;
            &lt;module name="java.net.http"/&gt;
        &lt;/dependencies&gt;
    &lt;/deployment&gt;
&lt;/jboss-deployment-structure&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This file must be placed in the <code>WEB-INF</code> directory in your WAR (or <code>META-INF</code> in case your application is a JAR).</p>
</div>
<div class="paragraph">
<p>To learn more about <code>jboss-deployment-structure.xml</code>, refer to the <a href="http://docs.wildfly.org/15/Developer_Guide.html#Class_Loading_in_WildFly">Class Loading chapter</a> in WildFly documentation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microprofile_2_2_support">MicroProfile 2.2 support</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thorntail now implements MicroProfile 2.2 by including the latest <a href="https://www.smallrye.io/">SmallRye</a> artifacts.
These specifications have been updated to a new version:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Fault Tolerance 2.0</p>
</li>
<li>
<p>OpenAPI 1.1</p>
</li>
<li>
<p>OpenTracing 1.3</p>
</li>
<li>
<p>Rest Client 1.2</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_microprofile_jwt_improvements">MicroProfile JWT improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One new fraction was added that improves Keycloak integration with MicroProfile JWT: <code>keycloak-microprofile-jwt</code>.</p>
</div>
<div class="paragraph">
<p>Also it is now much easier to configure MicroProfile JWT itself.
Previously, you had to use a giant chunk of YAML like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">thorntail:
  security:
    security-domains:
      test-realm:
        jaspi-authentication:
          login-module-stacks:
            test-login-module-stack:
              login-modules:
              - login-module: jwt-login-module
                code: org.wildfly.swarm.microprofile.jwtauth.deployment.auth.jaas.JWTLoginModule
                flag: required
                module-options:
                  rolesProperties: role-mapping.properties
          auth-modules:
            http:
              code: org.wildfly.extension.undertow.security.jaspi.modules.HTTPSchemeServerAuthModule
              module: org.wildfly.extension.undertow
              flag: required
              login-module-stack-ref: test-login-module-stack</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is now enough to write this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">thorntail:
  microprofile:
    jwtauth:
      realm: test-realm
      roles:
        file: role-mapping.properties</code></pre>
</div>
</div>
<div class="paragraph">
<p>Internally, the second configuration is transformed to the first one, so the behavior is identical.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_gradle_improvements">Gradle improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thorntail Gradle plugin has seen yet another round of improvements in 2.4.0.Final.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thorntail_runner_improvements">Thorntail Runner improvements</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Thorntail Runner has been updated to better support working with multi-module projects in the IDE.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_changelog">Changelog</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Release notes for 2.4.0.Final are available <a href="https://issues.jboss.org/secure/ReleaseNote.jspa?projectId=12317020&amp;version=12339973">here</a>.</p>
</div>
<div class="sect2">
<h3 id="_feature_request">Feature Request</h3>
<div class="ulist">
<ul>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-1594">THORN-1594</a>] Verify/Fix execution on JDK 11 (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2324">THORN-2324</a>] provide the ability to toggle filtering of WEB-INF/lib (Done)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_enhancement">Enhancement</h3>
<div class="ulist">
<ul>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-1852">THORN-1852</a>] MP JWT Fraction should integrate with the Keycloak client token introspector/verifier (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2313">THORN-2313</a>] Gradle plugin: provide tasks to run|start|stop the application (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2325">THORN-2325</a>] update default favicon with thorntail logo (Done)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_task">Task</h3>
<div class="ulist">
<ul>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-1933">THORN-1933</a>] MP FT - align CircuitBreaker.failOn() functionality once the spec issue is resolved (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2297">THORN-2297</a>] upgrade Keycloak to the latest 4.8.x.Final (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2339">THORN-2339</a>] Infinispan fraction should be added to supported fractions (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2352">THORN-2352</a>] Simplify microprofile-jwt configuration of the authentication module (Done)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_epic">Epic</h3>
<div class="ulist">
<ul>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2248">THORN-2248</a>] SmallRye MP 2.2 Impls (Done)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_component_upgrade">Component Upgrade</h3>
<div class="ulist">
<ul>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2251">THORN-2251</a>] Fault Tolerance 2.0 (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2256">THORN-2256</a>] REST Client 1.2 (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2259">THORN-2259</a>] OpenTracing 1.3 (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2260">THORN-2260</a>] OpenAPI 1.1 (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2340">THORN-2340</a>] update OpenShift REST Client Java to 7.0.0 (Done)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_bug">Bug</h3>
<div class="ulist">
<ul>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2287">THORN-2287</a>] Multi-module projects with files in the same directories, e.g. META-INF/beans.xml (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2307">THORN-2307</a>] build fails on JDK 11 (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2311">THORN-2311</a>] conflicting definitions of the org.eclipse.microprofile.restclient module (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2312">THORN-2312</a>] Runner fails with ZipException: duplicate entry: /WEB-INF/classes/META-INF/jandex.idx (Duplicate Issue)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2315">THORN-2315</a>] thorntail-maven-plugin chokes on scanning Java 11 classes (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2319">THORN-2319</a>] Fraction 'full' does not contain JSON-B and EE Security fractions (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2322">THORN-2322</a>] Thorntail Maven Plugin Strips Required Dependencies from WEB-INF/lib (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2327">THORN-2327</a>] JSF fraction doesn&#8217;t transitively bring in the JSF API (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2332">THORN-2332</a>] Messaging-Cluster example does not work (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2333">THORN-2333</a>] io.thorntail:microprofile-restclient (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2335">THORN-2335</a>] Invalid META-INF/services record in microprofile-restclient fraction (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2338">THORN-2338</a>] javaee-api:7.0 transitive dependency in 2.3.0.Final (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2349">THORN-2349</a>] fraction plugin passes old system properties (swarm.*) when building offline Maven repository (Done)</p>
</li>
<li>
<p>[<a href="https://issues.jboss.org/browse/THORN-2350">THORN-2350</a>] upgrade to fraction plugin 94 (Done)</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_resources">Resources</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Per usual, we tend to hang out on <code>irc.freenode.net</code> in <code>#thorntail</code>.</p>
</div>
<div class="paragraph">
<p>All bug and feature-tracking is kept in <a href="http://issues.jboss.org/browse/THORN">JIRA</a>.</p>
</div>
<div class="paragraph">
<p>Examples are available in <a href="https://github.com/thorntail/thorntail-examples/tree/2.4.0.Final" class="bare">https://github.com/thorntail/thorntail-examples/tree/2.4.0.Final</a></p>
</div>
<div class="paragraph">
<p>Documentation for this release is available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://docs.wildfly-swarm.io/2.4.0.Final/">Documentation</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_thank_you_contributors">Thank you, Contributors!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>We appreciate all of our contributors since the last release:</p>
</div>
<div class="sect2">
<h3 id="_core">Core</h3>
<div class="ulist">
<ul>
<li>
<p>Sergey Beryozkin</p>
</li>
<li>
<p>Ken Finnigan</p>
</li>
<li>
<p>Tomas Hofman</p>
</li>
<li>
<p>Erik Mattheis</p>
</li>
<li>
<p>Harsha Ramesh</p>
</li>
<li>
<p>Antoine Sabot-Durand</p>
</li>
<li>
<p>Michal Szynkiewicz</p>
</li>
<li>
<p>Ladislav Thon</p>
</li>
<li>
<p>Harald Wellmann</p>
</li>
<li>
<p>Eric Wittmann</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_examples">Examples</h3>
<div class="ulist">
<ul>
<li>
<p>icer33</p>
</li>
<li>
<p>Sergey Beryozkin</p>
</li>
<li>
<p>Ken Finnigan</p>
</li>
<li>
<p>Tomas Hofman</p>
</li>
<li>
<p>Scott M Stark</p>
</li>
<li>
<p>Gunnar Morling</p>
</li>
<li>
<p>Sven Ruppert</p>
</li>
<li>
<p>Ladislav Thon</p>
</li>
<li>
<p>Axel Wathne</p>
</li>
</ul>
</div>
</div>
</div>
</div></div></article></div></div></div></div><div class="footer-v1"><div class="footer"><div class="container"><div class="row"><div class="col-sm-6 md-margin-bottom-40"><p class="text-center"><Copyright>2016 - 2018 <a href="http://redhat.com">Red Hat, Inc.</a> | Thorntail is Open Source Software</Copyright></p></div></div></div></div></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-83419890-2', 'auto');
ga('send', 'pageview');

ga('create', 'UA-6435340-8', 'auto');
ga('send', 'pageview');
</script><script type="text/javascript" src="/assets/js/highlight.pack.js"></script><script type="text/javascript" src="/assets/plugins/jquery/jquery.min.js"></script><script type="text/javascript" src="/assets/plugins/jquery/jquery-migrate.min.js"></script><script type="text/javascript" src="/assets/plugins/bootstrap/js/bootstrap.min.js"></script><script type="text/javascript" src="/assets/plugins/back-to-top.js"></script><script type="text/javascript" src="/assets/plugins/smoothScroll.js"></script><script type="text/javascript" src="/assets/plugins/parallax-slider/js/modernizr.js"></script><script type="text/javascript" src="/assets/plugins/parallax-slider/js/jquery.cslider.js"></script><script type="text/javascript" src="/assets/plugins/owl-carousel/owl-carousel/owl.carousel.js"></script><script type="text/javascript" src="/assets/js/custom.js"></script><script type="text/javascript" src="/assets/js/app.js"></script><script type="text/javascript" src="/assets/js/plugins/owl-carousel.js"></script><script type="text/javascript" src="/assets/js/plugins/style-switcher.js"></script><script type="text/javascript" src="/assets/js/plugins/parallax-slider.js"></script><script>(function() {

  jQuery(document).ready(function() {
    App.init();
    OwlCarousel.initOwlCarousel();
    StyleSwitcher.initStyleSwitcher();
    ParallaxSlider.initParallaxSlider();

    hljs.initHighlightingOnLoad();
  });

})();
</script></body></html>